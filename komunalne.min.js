function Komunalne(){}Komunalne.helper={},Komunalne.util={},Komunalne.format={},Komunalne.test={},Komunalne.$={},Komunalne.dom={},Komunalne.anim={},void 0===window.K&&(window.K=Komunalne),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c;if(null==this)throw new TypeError('"this" is null or not defined');var d=Object(this),e=d.length>>>0;if(0===e)return-1;var f=+b||0;if(Math.abs(f)===1/0&&(f=0),f>=e)return-1;for(c=Math.max(f>=0?f:e-Math.abs(f),0);c<e;){if(c in d&&d[c]===a)return c;c++}return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d=void 0;if(null==this)throw new TypeError(" this is null or not defined");var e=Object(this),f=e.length>>>0;if("function"!=typeof a)throw new TypeError(a+" is not a function");for(arguments.length>1&&(d=b),c=0;c<f;){var g;c in e&&(g=e[c],a.call(d,g,c,e)),c++}}),Komunalne.$.elementText=function(a,b){return Komunalne.dom.elementText($(a).get(0),b)},Komunalne.$.fullHeight=function(a){var b;b=function(a){$(a).css("min-height",$(window).height())},a=Komunalne.util.isArray(a)?a:[a],a.forEach(function(a){var c=b.bind(null,a);$(window).resize(c),$(window).load(c)})},Komunalne.anim.animate=function(a,b){var c="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend";return new Promise(function(d,e){a=Komunalne.util.append("animated",a),$(b).addClass(a).one(c,function(){$(this).removeClass(a),d(this)})})},Komunalne.anim.animation=function(a,b,c,d){var e,f="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",g="webkitAnimationStart mozAnimationStart MSAnimationStart oanimationstart animationstart";return a=Komunalne.util.append("animated",a),b=$(b),e=function(e,h){var i=function(){b.removeClass(a),d(b),e(b)};b.addClass(a).one(g,c).one(f,i)},new Promise(e)},Komunalne.dom.elementText=function(a,b){var c,d,e=null,f=Komunalne.util.isInstanceOf(a,"string")?document.getElementById(a):a;if(null!=f)if(f.hasChildNodes())if(null!=b){for(c=new Komunalne.helper.Iterator(f.childNodes);c.hasNext()&&(e=c.next(),3!=e.nodeType);)e=null;null!=e?e.nodeValue=b:f.appendChild(document.createTextNode(b))}else{for(d=[],c=new Komunalne.helper.Iterator(f.childNodes);c.hasNext();)e=c.next(),3==e.nodeType&&d.push(e.nodeValue);b=d.join()}else null!=b?f.appendChild(document.createTextNode(b)):b="";else b=null;return b},Komunalne.format.currency=function(a,b,c,d){if("number"!=typeof a)throw"Formatting a non-number";b=""===b||null===b||isNaN(b=Math.abs(b))?2:b,c=void 0!=c?c:".",d=void 0!=d?d:",";var e=a<0?"-":"",f=a.toFixed(b),g=Math.abs(parseInt(f)).toString(),h=Math.abs(f).toString().substr(g.length+1,b);h=h.length<b?h+new Array(b-h.length+1).join("0"):h;for(var i="",j=g.length;j-3>0;j-=3)i=d+g.substr(j-3,3)+i;return i=e+g.substring(0,j)+i,i+(h.length>0?c+h:"")},Komunalne.format.capitalize=function(a){return a[0].toUpperCase()+a.substr(1).toLowerCase()},Komunalne.helper.Method=function(a,b){this.fn=a,this.scope=void 0!=b?b:null},Komunalne.helper.Method.prototype.apply=function(a){return this.fn.apply(this.scope,a)},Komunalne.helper.Method.prototype.call=function(){return this.fn.apply(this.scope,arguments)},Komunalne.helper.Iterator=function(a){this.keys=Komunalne.util.keys(a),this.i=0,this.ref=a},Komunalne.helper.Iterator.keyError="Iterator has not started to retrieve elements",Komunalne.helper.Iterator.nextError="Iterator index out of bounds: ",Komunalne.helper.Iterator.prototype.hasNext=function(){return this.i<this.keys.length},Komunalne.helper.Iterator.prototype.next=function(){if(!this.hasNext())throw Komunalne.helper.Iterator.nextError+this.i;return this.ref[this.keys[this.i++]]},Komunalne.helper.Iterator.prototype.length=function(){return this.keys.length},Komunalne.helper.Iterator.prototype.remaining=function(){return this.length()-this.i},Komunalne.helper.Iterator.prototype.currentKey=function(){if(0===this.i)throw Komunalne.helper.Iterator.keyError;return this.keys[this.i-1]},Komunalne.test.Case=function(a){a=a||{},this.expected=a.expected,this.args=a.args,this.msg=a.msg},Komunalne.test.Case.prototype.execute=function(a,b){var c=[];a=Komunalne.test.Case.transform(a),b=Komunalne.test.Case.transform(b),void 0!==this.expected&&c.push(this.expected),b&&Komunalne.util.isArray(this.args)&&c.push(b.apply(this.args)),void 0!=this.msg&&c.push(this.msg.toString()),a.apply(c)},Komunalne.test.Case.transform=function(a){return Komunalne.util.isFunction(a)?new Komunalne.helper.Method(a):a},Komunalne.test.Suite=function(a){this.cases=void 0==a?[]:Komunalne.util.isArray(a)?a:a instanceof Komunalne.test.Case?[a]:[]},Komunalne.test.Suite.prototype.size=function(){return this.cases.length},Komunalne.test.Suite.prototype.iterator=function(){return new Komunalne.helper.Iterator(this.cases)},Komunalne.test.Suite.prototype.add=function(a,b,c){this.cases.push(new Komunalne.test.Case(a,b,c))},Komunalne.test.Suite.prototype.clear=function(){this.cases=[]},Komunalne.test.Suite.prototype.execute=function(a,b){var c=this.iterator();for(a=Komunalne.test.Case.transform(a),b=Komunalne.test.Case.transform(b);c.hasNext();)c.next().execute(a,b)},function(){window.QUnit&&(QUnit.assert.buildFor=function(a){return new Komunalne.helper.Method(this[a],this)})}(),Komunalne.util.append=function(a,b,c){return((a||"")+(c||" ")+(b||"")).trim()},Komunalne.util.path=function(a,b){if(""===b)return a;var c=b.split("."),d=a;for(var e in c){if(!Komunalne.util.isInstanceOf(d,Object)||void 0===d[c[e]]){d=null;break}d=d[c[e]]}return d},Komunalne.util.isDate=function(a,b){return a instanceof Date&&(!b||!isNaN(a.valueOf()))},Komunalne.util.isFunction=function(a){return"function"==typeof a},Komunalne.util.isIterable=function(a){return"object"==typeof a&&void 0!=a&&!Komunalne.util.isDate(a)},Komunalne.util.isArray=function(a){return Komunalne.util.isIterable(a)&&a.constructor&&a.constructor==Array},Komunalne.util.isInstanceOf=function(a,b){var c;if("string"==typeof b)c=typeof a==b;else{if(!Komunalne.util.isFunction(b))throw"Invalid comparison of "+typeof a+" against "+typeof b;c=a instanceof Object?a.constructor===b:a instanceof b}return c},Komunalne.util.isArrayOf=function(a,b){for(var c=Komunalne.util.isArray(a),d=new Komunalne.helper.Iterator(a,b);c&&d.hasNext();)c=Komunalne.util.isInstanceOf(d.next(),b);return c},Komunalne.util.areSameClass=function(a,b){return typeof a==typeof b&&("object"!=typeof a||a.constructor===b.constructor)},Komunalne.util.deepEquals=function(a,b){var c,d,e,f,g,h,i=!0;if(c=Komunalne.util.isIterable(a),d=Komunalne.util.isIterable(b),c&&d&&(i=Komunalne.util.areSameClass(a,b)))for(e=new Komunalne.helper.Iterator(a),f=new Komunalne.helper.Iterator(b),i=e.length()==f.length();e.hasNext()&&i;)g=e.next(),h=f.next(),i=Komunalne.util.deepEquals(g,h),i=i&&e.currentKey()==f.currentKey();else i=c==d&&a===b;return i},Komunalne.util.arrayContains=function(a,b,c){var d,e;if(c===!0)for(d=new Komunalne.helper.Iterator(b),e=!1;d.hasNext()&&!e;)e=Komunalne.util.deepEquals(a,d.next());else e=b.indexOf(a)>=0;return e},Komunalne.util.isAnyOf=function(a){return Komunalne.util.arrayContains(a,Array.prototype.slice.call(arguments,1))},Komunalne.util.arrayConcat=function(){for(var a=[],b=new Komunalne.helper.Iterator(arguments);b.hasNext();)a=a.concat(b.next());return a},Komunalne.util.forEach=function(a,b,c){for(var d=new Komunalne.helper.Iterator(a);d.hasNext();)b.call(c,d.next(),d.currentKey(),a)},Komunalne.util.clone=function(a,b){var c,d,e,f,g=[],h=[],i=!0;if(b=b||{},"into"in b&&(!Komunalne.util.isInstanceOf(b.into,"object")||null==b.into))throw Komunalne.util.clone.invalidTarget;c=function(a,c){return j(a,b,c)},d=function(a){return a},e="skip"in b?Komunalne.util.isArray(b.skip)&&Komunalne.util.isArrayOf(b.skip,"string")?b.skip:Komunalne.util.isInstanceOf(b.skip,"string")?[b.skip]:[]:[],f=function(a){var b,c=Komunalne.util.clone(a);for(var d in c)c[d]=(b=c[d].indexOf("."))>=0?c[d].substr(b+1):"";return c};var j=function(a,b,e){var j,k,l,m;if(null!=a&&Komunalne.util.isInstanceOf(a,"object"))if(Komunalne.util.isInstanceOf(a,Date))j=new Date(a.getTime());else if(b.deep===!0&&(k=g.indexOf(a))>=0)j=h[k];else{if(g.push(a),i&&"into"in b)j=b.into;else try{j=new a.constructor}catch(b){j=a}h.push(j),i=!1,b.deep===!0?(l=c,m=f(e)):(l=d,m=[]);for(var n in a)Komunalne.util.arrayContains(n,e)||(j[n]=b.safe!==!0||void 0===j[n]?l(a[n],m):j[n])}else j=a;return j};return j(a,b,e)},Komunalne.util.clone.invalidTarget="Target object is null or not an object",Komunalne.util.keys=function(a){var b=[];a=a||{};for(var c in a)b.push(c);return b};
